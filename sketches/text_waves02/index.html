<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Waves Sketch</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@2.0.1/lib/p5.js"></script>
    <script src="javascript/googleFonts.js"></script>    
    <script src="javascript/sketch.js"></script>
    <script src="javascript/presets.js"></script>
    <script src="javascript/export.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
    <script src="javascript/xboxController.js"></script>
    <link rel="stylesheet" href="style.css">
    
</head>

<body>

    <button id="uiToggle" title="Toggle UI Panel">X</button>

    <div id="ui">
        <div class="global-controls">
            <button id="shuffleButton" class="action-button">* Surprise Me *</button>
        </div>

        <!-- Text Controls -->
        <h3>Text <button onclick="toggleSection('textControls')">▼</button></h3>
        <div id="textControls">
            <div class="control-group">
                <label for="textInput">Text:</label>
                <textarea id="textInput" rows="2">hello how are you</textarea>
            </div>
            <div class="control-group">
                <label for="defaultGifSelect">Image/Gif:</label>
                <select id="defaultGifSelect" class="gif-select">
                    <option value="">Select a default GIF</option>
                    <option value="gifs/sassy_hand.gif">Sassy Hand</option>
                    <option value="gifs/big_baby.gif">Big Baby</option>
                    <option value="gifs/blob.gif">Blob</option>
                    <option value="gifs/eye.gif">Eye</option>
                    <option value="gifs/monster_turning.gif">Monster Turning</option>
                    <option value="gifs/pixel_money.gif">Pixel Money</option>
                    <option value="gifs/pixel_pug.gif">Pixel Pug</option>
                    <option value="gifs/rainbow_coin.gif">Rainbow Coin</option>
                    
                    
                    <!-- Add more options for each GIF -->
                </select>
            </div>
            <div class="control-group">
                <label for="imageInput">Custom File:</label>
                <input type="file" id="imageInput" accept="image/*">
            </div>
            <div class="control-group">
                <label for="textSplitMode">Text Split Mode:</label>
                <select id="textSplitMode">
                    <option value="sentence">Sentence</option>
                    <option value="word" selected>Word</option>
                    <option value="char">Character</option>
                </select>
            </div>
            <div class="control-group">
                <label for="fontSelection">Font:</label>
                <select id="fontSelection">
                    <option value="Wix Madefor Text">Wix Madefor Text</option>
                    <option value="Roboto Flex">Roboto Flex</option>
                    <option value="Playwrite NZ">Playwrite NZ</option>
                </select>
            </div>

            <div class="control-group slider-group">
                <label for="fontSize">Size:</label>
                <input type="range" id="fontSize" min="10" max="300" step="1" value="50">
                <span id="fontSizeValue">50</span>
            </div>

            <div class="control-group checkbox-group">
                <label for="autoPulseFontSize">Auto Pulse Size</label>
                <input type="checkbox" id="autoPulseFontSize">
            </div>

            <div class="control-group slider-group">
                <label for="fontWeight">Weight:</label>
                <input type="range" id="fontWeight" min="100" max="800" step="1" value="400">
                <span id="fontWeightValue">400</span>
            </div>

            <div class="control-group checkbox-group">
                <label for="autoPulseWeight">Auto Pulse Weight</label>
                <input type="checkbox" id="autoPulseWeight">
            </div>

            <div class="control-group button-group">
                <label>Repetitions:</label>
                <button id="decreaseRepetitions">-</button>
                <span id="numRepetitions">1</span>
                <button id="increaseRepetitions">+</button>
            </div>

            <div class="control-group button-group">
                <label>Element Spacing:</label>
                <button id="decreaseSpaceBetweenWords">-</button>
                <span id="spaceBetweenWordsValue">0</span>
                <button id="increaseSpaceBetweenWords">+</button>
            </div>

            <div class="control-group">
                <label for="blendModeDropdown">Blend Mode:</label>
                <select id="blendModeDropdown">
                    <option value="BLEND">Blend</option>
                    <option value="ADD">Add</option>
                    <option value="DARKEST">Darkest</option>
                    <option value="LIGHTEST">Lightest</option>
                    <option value="DIFFERENCE">Difference</option>
                    <option value="EXCLUSION">Exclusion</option>
                    <option value="MULTIPLY">Multiply</option>
                    <option value="SCREEN">Screen</option>
                    <option value="REPLACE">Replace</option>
                </select>
            </div>

            <div class="control-group color-group">
                <label for="backgroundColor">Background:</label>
                <input type="color" id="backgroundColor" value="#202004">
            </div>

            <div class="control-group color-group">
                <label for="textColor1">Color 1:</label>
                <input type="color" id="textColor1" value="#ed6c44">
            </div>

            <div class="control-group color-group">
                <label for="textColor2">Color 2:</label>
                <input type="color" id="textColor2" value="#e667fc">
            </div>

            <div class="control-group color-group">
                <label for="textColor3">Color 3:</label>
                <input type="color" id="textColor3" value="#3638b1">
            </div>
        </div>

        <!-- Animation Controls -->
        <h3>Animation <button onclick="toggleSection('animationControls')">▼</button></h3>
        <div id="animationControls">
            <div class="control-group slider-group">
                <label for="speed">Speed:</label>
                <input type="range" id="speed" min="0" max="10" step="0.01" value="1">
                <span id="speedValue">1</span>
            </div>

            <div class="control-group checkbox-group">
                <label for="rotateWithFlow">Rotate On Wave Path</label>
                <input type="checkbox" id="rotateWithFlow">
            </div>

            <div class="control-group checkbox-group">
                <label for="rotateWithPosition">Rotate With Position</label>
                <input type="checkbox" id="rotateWithPosition">
            </div>

            <div class="control-group checkbox-group">
                <label for="reverseAnimation">Reverse Animation</label>
                <input type="checkbox" id="reverseAnimation">
            </div>

            <div class="control-group slider-group">
                <label for="stepBetweenWords">Frequency:</label>
                <input type="range" id="stepBetweenWords" min="0" max="100" step="1" value="30">
                <span id="stepBetweenWordsValue">30</span>
            </div>

            <h4>X Axis</h4>
            <div class="control-group">
                <label for="waveTypeX">Type:</label>
                <select id="waveTypeX">
                    <option value="sin">Sin</option>
                    <option value="cos">Cos</option>
                    <option value="tan">Tan</option>
                    <option value="static">Static</option>
                </select>
            </div>

            <div class="control-group slider-group">
                <label for="xPhase">Phase:</label>
                <input type="range" id="xPhase" min="0" max="2" step="0.1" value="0.5">
                <span id="xPhaseValue">0.5</span>
            </div>

            <div class="control-group slider-group">
                <label for="xMagnitude">Width:</label>
                <input type="range" id="xMagnitude" min="-1" max="1" step="0.1" value="0.4">
                <span id="xMagnitudeValue">0.4</span>
            </div>

            <h4>Y Axis</h4>
            <div class="control-group">
                <label for="waveTypeY">Type:</label>
                <select id="waveTypeY">
                    <option value="sin">Sin</option>
                    <option value="cos">Cos</option>
                    <option value="tan">Tan</option>
                    <option value="static">Static</option>
                </select>
            </div>

            <div class="control-group slider-group">
                <label for="yPhase">Phase:</label>
                <input type="range" id="yPhase" min="0" max="2" step="0.1" value="0.5">
                <span id="yPhaseValue">0.5</span>
            </div>

            <div class="control-group slider-group">
                <label for="yMagnitude">Height:</label>
                <input type="range" id="yMagnitude" min="-1" max="1" step="0.1" value="0.22">
                <span id="yMagnitudeValue">0.22</span>
            </div>
        </div>

        <!-- Wave Controls -->
        <h3>Wave <button onclick="toggleSection('debugControls')">▼</button></h3>
        <div id="debugControls">
            <div class="control-group checkbox-group">
                <label for="showWave">Show Wave</label>
                <input type="checkbox" id="showWave" checked>
            </div>
            <div class="control-group color-group">
                <label for="waveDebugColor">Wave Color</label>
                <input type="color" id="waveDebugColor" value="#006400">
            </div>
            <div class="control-group">
                <label for="debugWaveType">Debug Wave Shape:</label>
                <select id="debugWaveType">
                    <option value="circle">Circle</option>
                    <option value="square">Square</option>
                    <option value="triangle">Triangle</option>
                    <option value="line">Line</option>
                    <option value="cross">Cross</option>
                    <option value="rhombus">Rhombus</option>
                </select>
            </div>
        </div>

        <!-- Canvas Controls -->
        <h3>Canvas <button onclick="toggleSection('canvasControls')">▼</button></h3>
        <div id="canvasControls">
            <div class="control-group">
                <label for="canvasPreset">Preset Size:</label>
                <select id="canvasPreset">
                    <option value="custom">Custom</option>
                    <option value="1920x1080">1920 x 1080 (Full HD)</option>
                    <option value="1280x720">1280 x 720 (HD)</option>
                    <option value="800x600">800 x 600</option>
                    <option value="600x600">600 x 600 (Square)</option>
                    <option value="1080x1080">1080 x 1080 (Instagram Post)</option>
                    <option value="1080x1920">1080 x 1920 (Instagram Story)</option>
                    <option value="1080x1350">1080 x 1350 (Instagram Portrait)</option>
                    <option value="1080x608">1080 x 608 (Instagram Landscape)</option>
                    <option value="1080x1920">1080 x 1920 (Instagram Reels)</option>
                </select>
            </div>

            <div class="control-group slider-group">
                <label for="canvasWidth">Width:</label>
                <input type="range" id="canvasWidth" min="100" max="3000" step="1" value="3000">
                <span id="canvasWidthValue">3000</span>
            </div>

            <div class="control-group slider-group">
                <label for="canvasHeight">Height:</label>
                <input type="range" id="canvasHeight" min="100" max="3000" step="1" value="3000">
                <span id="canvasHeightValue">3000</span>
            </div>
        </div>

        <br><br><br>
        <h3>Presets <button onclick="toggleSection('presetControls')">▼</button></h3>
        <div id="presetControls">
            <div id="presetContainer"></div>
            <div class="preset-actions">
                <button id="savePresetButton">Save Preset</button>
                <button id="loadPresetButton">Load Preset</button>
                <input type="file" id="presetFileInput" style="display: none;" accept=".json">
            </div>
        </div>
    </div>

    <div id="canvasWrapper"></div>
    
    <!-- Add the export button -->
    <button id="exportButton" class="export-button">Export</button>
  
    <script>
        // Function to update the value display
        function updateValueDisplay(id, value) {
            document.getElementById(id + 'Value').textContent = value;
        }

        // Function to enable or disable inputs based on wave type
        function toggleInputs(waveTypeId, phaseId, magnitudeId) {
            const waveType = document.getElementById(waveTypeId).value;
            const isStatic = waveType === 'static';
            document.getElementById(phaseId).disabled = isStatic;
            document.getElementById(magnitudeId).disabled = isStatic;
        }

        // Add event listeners to update the value display
        document.getElementById('speed').addEventListener('input', function () {
            updateValueDisplay('speed', this.value);
        });

        document.getElementById('xPhase').addEventListener('input', function () {
            updateValueDisplay('xPhase', this.value);
        });

        document.getElementById('yPhase').addEventListener('input', function () {
            updateValueDisplay('yPhase', this.value);
        });

        document.getElementById('xMagnitude').addEventListener('input', function () {
            updateValueDisplay('xMagnitude', this.value);
        });

        document.getElementById('yMagnitude').addEventListener('input', function () {
            updateValueDisplay('yMagnitude', this.value);
        });

        document.getElementById('fontSize').addEventListener('input', function () {
            updateValueDisplay('fontSize', this.value);
        });

        document.getElementById('stepBetweenWords').addEventListener('input', function () {
            updateValueDisplay('stepBetweenWords', this.value);
        });

        // Add event listeners to toggle inputs based on wave type
        document.getElementById('waveTypeX').addEventListener('change', function () {
            toggleInputs('waveTypeX', 'xPhase', 'xMagnitude');
        });

        document.getElementById('waveTypeY').addEventListener('change', function () {
            toggleInputs('waveTypeY', 'yPhase', 'yMagnitude');
        });

        // Add event listener for reverseAnimation
        const reverseAnimationElement = document.getElementById('reverseAnimation');
        reverseAnimation = reverseAnimationElement.checked;
        reverseAnimationElement.addEventListener('change', function () {
            reverseAnimation = this.checked;
        });

        // Initial toggle to set the correct state on page load
        toggleInputs('waveTypeX', 'xPhase', 'xMagnitude');
        toggleInputs('waveTypeY', 'yPhase', 'yMagnitude');

        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section.style.display === 'none') {
                section.style.display = 'block';
            } else {
                section.style.display = 'none';
            }
        }

        // Initialize sections to be visible
        document.getElementById('textControls').style.display = 'block';
        document.getElementById('animationControls').style.display = 'block';
        document.getElementById('debugControls').style.display = 'block';
        document.getElementById('canvasControls').style.display = 'block';

        // Add UI toggle functionality
        const uiToggle = document.getElementById('uiToggle');
        const ui = document.getElementById('ui');

        uiToggle.addEventListener('click', function () {
            ui.classList.toggle('hidden');
            uiToggle.classList.toggle('hidden');
            // Update the grid template columns when UI is hidden
            document.body.style.gridTemplateColumns = ui.classList.contains('hidden') ? '0 1fr' : '300px 1fr';
        });

        // Add window resize handler for canvas size limits
        window.addEventListener('resize', function() {
            // Update slider max values based on window size
            const canvasWidthSlider = document.getElementById('canvasWidth');
            const canvasHeightSlider = document.getElementById('canvasHeight');
            
            // Set max values to window dimensions
            canvasWidthSlider.max = window.innerWidth;
            canvasHeightSlider.max = window.innerHeight;
            
            // If current values exceed new max, adjust them
            if (parseInt(canvasWidthSlider.value) > window.innerWidth) {
                canvasWidthSlider.value = window.innerWidth;
                updateValueDisplay('canvasWidth', window.innerWidth);
            }
            if (parseInt(canvasHeightSlider.value) > window.innerHeight) {
                canvasHeightSlider.value = window.innerHeight;
                updateValueDisplay('canvasHeight', window.innerHeight);
            }
        });

        // Initialize canvas size slider limits on page load
        window.addEventListener('load', function() {
            const canvasWidthSlider = document.getElementById('canvasWidth');
            const canvasHeightSlider = document.getElementById('canvasHeight');
            canvasWidthSlider.max = window.innerWidth;
            canvasHeightSlider.max = window.innerHeight;
        });

        // Add event listener for file input to reset dropdown
        document.getElementById('imageInput').addEventListener('change', function() {
            if (this.files.length > 0) {  // If a file was selected
                document.getElementById('defaultGifSelect').value = '';  // Reset to "Select a default GIF"
            }
        });
    </script>

</body>

</html>